/*! For license information please see main.f0032a4d.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var i=n(853),r=n(43),a=n(950);function s(e){var t="https://29ca1e8e-9c57-4a2c-9437-86ce9cfbfffc.preview.emergentagent.com",zv="".concat(Fv,"/api");console.log("Backend URL:",Fv),console.log("API URL:",zv);const Bv=e=>{let{children:t}=e;const[n,i]=(0,r.useState)((()=>{const e=localStorage.getItem("theme");return!!e&&"dark"===e}));return(0,r.useEffect)((()=>{document.documentElement.setAttribute("data-theme",n?"dark":"light")}),[n]),(0,Su.jsx)(Iv.Provider,{value:{darkMode:n,toggleTheme:()=>{i((e=>{const t=!e;return localStorage.setItem("theme",t?"dark":"light"),t}))}},children:(0,Su.jsx)("div",{className:"App ".concat(n?"dark":"light"),children:t})})},Vv=()=>{const{darkMode:e,toggleTheme:t}=Uv();return(0,Su.jsx)("button",{onClick:t,className:"theme-toggle-btn btn-enhanced p-2 rounded-lg transition-all duration-300",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},title:"Switch to ".concat(e?"light":"dark"," mode"),children:e?"\u2600\ufe0f":"\ud83c\udf19"})},Hv=e=>{let{darkMode:t}=e;return(0,Su.jsx)(Su.Fragment,{children:[{icon:"\u26a1",size:"2rem",top:"10%",left:"15%",delay:"0s"},{icon:"\ud83c\udfaf",size:"1.5rem",top:"20%",right:"20%",delay:"2s"},{icon:"\u2b50",size:"1.8rem",top:"70%",left:"10%",delay:"4s"},{icon:"\ud83d\udc8e",size:"1.6rem",bottom:"15%",right:"15%",delay:"1s"},{icon:"\ud83d\ude80",size:"2.2rem",top:"50%",left:"5%",delay:"3s"},{icon:"\ud83d\udd25",size:"1.4rem",top:"80%",right:"10%",delay:"5s"},{icon:"\ud83d\udcaa",size:"1.7rem",top:"30%",left:"8%",delay:"6s"},{icon:"\u2694\ufe0f",size:"1.9rem",bottom:"30%",left:"20%",delay:"7s"},{icon:"\ud83c\udfc6",size:"1.6rem",top:"60%",right:"25%",delay:"8s"},{icon:"\u26a1",size:"1.3rem",bottom:"50%",right:"5%",delay:"9s"},{icon:"\ud83c\udfaa",size:"1.8rem",top:"15%",left:"25%",delay:"10s"},{icon:"\ud83c\udfad",size:"1.5rem",bottom:"20%",left:"8%",delay:"11s"},{icon:"\ud83c\udfa8",size:"1.4rem",top:"85%",left:"30%",delay:"12s"},{icon:"\ud83c\udfb2",size:"1.6rem",top:"40%",right:"8%",delay:"13s"},{icon:"\u2b50",size:"1.2rem",bottom:"60%",left:"12%",delay:"14s"}].map(((e,n)=>(0,Su.jsx)("div",{className:"floating-doodle",style:u(u({},e),{},{fontSize:e.size,animationDelay:e.delay,opacity:t?.4:.3}),children:e.icon},n)))})},jv=e=>{let{requiredLevel:t}=e;return(0,Su.jsxs)("div",{className:"locked-tab-content",children:[(0,Su.jsx)("div",{className:"locked-background"}),(0,Su.jsxs)("div",{className:"lock-overlay",children:[(0,Su.jsx)("div",{className:"lock-icon",children:"\ud83d\udd12"}),(0,Su.jsxs)("div",{className:"lock-text",children:["Unlocks at level ",t]})]})]})},Wv=e=>{let{item:t,users:n,currentUser:i,onSelectUser:a,selectedUserId:s}=e;const[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),d=n.filter((e=>e.id!==i.id));return(0,r.useEffect)((()=>{if(s){const e=d.find((e=>e.id===s));u(e)}}),[s,d]),(0,Su.jsxs)("div",{className:"relative mb-3",children:[(0,Su.jsx)("div",{onClick:()=>l(!o),className:"custom-dropdown-trigger ".concat(o?"open":""),style:{backgroundColor:"var(--bg-secondary)",border:"2px solid var(--border-color)",borderRadius:"8px",padding:"12px 16px",cursor:"pointer",transition:"all 0.3s ease",position:"relative"},children:c?(0,Su.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Su.jsxs)("div",{className:"flex items-center space-x-3",children:[c.profile_picture?(0,Su.jsx)("img",{src:c.profile_picture,alt:c.username,className:"w-8 h-8 rounded-full object-cover"}):(0,Su.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:c.username.charAt(0).toUpperCase()}),(0,Su.jsxs)("div",{children:[(0,Su.jsx)("div",{className:"font-semibold",style:{color:"var(--text-primary)"},children:c.username}),(0,Su.jsxs)("div",{className:"text-xs flex items-center space-x-2",style:{color:"var(--text-muted)"},children:[(0,Su.jsxs)("span",{children:[c.credits," FC"]}),c.level>1&&(0,Su.jsxs)("span",{className:"bg-yellow-500 text-black px-1.5 py-0.5 rounded text-xs",children:["L",c.level]})]})]})]}),(0,Su.jsx)("div",{className:"dropdown-arrow ".concat(o?"rotate-180":""),style:{transition:"transform 0.3s ease",color:"var(--text-secondary)"},children:"\u25bc"})]}):(0,Su.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Su.jsx)("span",{style:{color:"var(--text-muted)"},children:"Select target user"}),(0,Su.jsx)("div",{className:"dropdown-arrow ".concat(o?"rotate-180":""),style:{transition:"transform 0.3s ease",color:"var(--text-secondary)"},children:"\u25bc"})]})}),o&&(0,Su.jsx)("div",{className:"custom-dropdown-menu",style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"var(--bg-secondary)",border:"2px solid var(--border-color)",borderRadius:"8px",marginTop:"4px",zIndex:1e3,maxHeight:"200px",overflowY:"auto",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",animation:"slideIn 0.2s ease-out"},children:0===d.length?(0,Su.jsx)("div",{className:"px-4 py-3 text-center",style:{color:"var(--text-muted)"},children:"No other users available"}):d.map(((e,t)=>(0,Su.jsxs)("div",{onClick:()=>(e=>{u(e),a(e.id),l(!1)})(e),className:"dropdown-item flex items-center space-x-3 px-4 py-3 cursor-pointer transition-all duration-200",style:{borderBottom:t<d.length-1?"1px solid var(--border-color)":"none",backgroundColor:"transparent"},onMouseEnter:e=>{e.target.style.backgroundColor="var(--bg-tertiary)"},onMouseLeave:e=>{e.target.style.backgroundColor="transparent"},children:[e.profile_picture?(0,Su.jsx)("img",{src:e.profile_picture,alt:e.username,className:"w-8 h-8 rounded-full object-cover"}):(0,Su.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:e.username.charAt(0).toUpperCase()}),(0,Su.jsxs)("div",{className:"flex-1",children:[(0,Su.jsx)("div",{className:"font-semibold",style:{color:"var(--text-primary)"},children:e.username}),(0,Su.jsxs)("div",{className:"text-xs flex items-center space-x-2",style:{color:"var(--text-muted)"},children:[(0,Su.jsxs)("span",{children:[e.credits," FC"]}),e.level>1&&(0,Su.jsxs)("span",{className:"bg-yellow-400 text-black px-1.5 py-0.5 rounded text-xs",children:["L",e.level]})]})]})]},e.id)))})]})},Gv=e=>{let{user:t,isOpen:n,onClose:i}=e;return n&&t?(0,Su.jsx)("div",{className:"modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:i,children:(0,Su.jsxs)("div",{className:"modal-content card-enhanced p-6 rounded-lg max-w-md w-full mx-4 relative",onClick:e=>e.stopPropagation(),style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,Su.jsx)("button",{onClick:i,className:"absolute top-4 right-4 text-2xl opacity-70 hover:opacity-100",style:{color:"var(--text-primary)"},children:"\xd7"}),(0,Su.jsxs)("div",{className:"text-center mb-6",children:[t.profile_picture?(0,Su.jsx)("img",{src:t.profile_picture,alt:t.username,className:"w-20 h-20 rounded-full mx-auto mb-4 object-cover"}):(0,Su.jsx)("div",{className:"w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center text-2xl font-bold",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:t.username.charAt(0).toUpperCase()}),(0,Su.jsxs)("h2",{className:"text-2xl font-bold flex items-center justify-center",children:[t.username,t.level>1&&(0,Su.jsxs)("span",{className:"ml-2 bg-yellow-500 text-black px-2 py-1 rounded text-sm",children:["L",t.level]})]}),t.bio&&(0,Su.jsx)("p",{className:"text-sm opacity-80 mt-2",children:t.bio})]}),(0,Su.jsxs)("div",{className:"space-y-4",children:[(0,Su.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Su.jsxs)("div",{className:"stats-item text-center p-3 rounded",style:{backgroundColor:"var(--bg-secondary)"},children:[(0,Su.jsx)("div",{className:"text-xl font-bold",children:t.credits}),(0,Su.jsx)("div",{className:"text-sm opacity-70",children:"Focus Credits"})]}),(0,Su.jsxs)("div",{className:"stats-item text-center p-3 rounded",style:{backgroundColor:"var(--bg-secondary)"},children:[(0,Su.jsx)("div",{className:"text-xl font-bold",children:t.total_focus_time}),(0,Su.jsx)("div",{className:"text-sm opacity-70",children:"Minutes Focused"})]})]}),(0,Su.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Su.jsxs)("div",{className:"stats-item text-center p-3 rounded",style:{backgroundColor:"var(--bg-secondary)"},children:[(0,Su.jsxs)("div",{className:"text-xl font-bold",children:[t.credit_rate_multiplier.toFixed(1),"x"]}),(0,Su.jsx)("div",{className:"text-sm opacity-70",children:"Credit Rate"})]}),(0,Su.jsxs)("div",{className:"stats-item text-center p-3 rounded",style:{backgroundColor:"var(--bg-secondary)"},children:[(0,Su.jsx)("div",{className:"text-xl font-bold",children:t.completed_tasks||0}),(0,Su.jsx)("div",{className:"text-sm opacity-70",children:"Tasks Done"})]})]})]}),(0,Su.jsx)("div",{className:"mt-6 text-center",children:(0,Su.jsx)("button",{onClick:i,className:"btn-enhanced px-6 py-2 rounded-lg",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:"Close"})})]})}):null},Xv=e=>{let{isOpen:t,onClose:n,currentUser:i,onUpdateUser:a}=e;const[s,o]=(0,r.useState)({username:"",bio:"",profilePicture:"",currentPassword:"",newPassword:"",confirmPassword:""});(0,r.useEffect)((()=>{i&&t&&o({username:i.username||"",bio:i.bio||"",profilePicture:i.profile_picture||"",currentPassword:"",newPassword:"",confirmPassword:""})}),[i,t]);return t?(0,Su.jsx)("div",{className:"modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:n,children:(0,Su.jsxs)("div",{className:"modal-content card-enhanced p-6 rounded-lg max-w-md w-full mx-4 relative max-h-screen overflow-y-auto",onClick:e=>e.stopPropagation(),style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,Su.jsx)("button",{onClick:n,className:"absolute top-4 right-4 text-2xl opacity-70 hover:opacity-100",style:{color:"var(--text-primary)"},children:"\xd7"}),(0,Su.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Settings"}),(0,Su.jsxs)("div",{className:"settings-section mb-6",children:[(0,Su.jsx)("h3",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Profile Information"}),(0,Su.jsx)("input",{type:"text",placeholder:"Username",value:s.username,onChange:e=>o((t=>u(u({},t),{},{username:e.target.value}))),className:"form-input form-input-animated w-full p-3 rounded mb-4"}),(0,Su.jsx)("input",{type:"text",placeholder:"Profile Picture URL (optional)",value:s.profilePicture,onChange:e=>o((t=>u(u({},t),{},{profilePicture:e.target.value}))),className:"form-input form-input-animated w-full p-3 rounded mb-4"}),(0,Su.jsx)("textarea",{placeholder:"Bio (optional)",value:s.bio,onChange:e=>o((t=>u(u({},t),{},{bio:e.target.value}))),className:"form-input form-input-animated w-full p-3 rounded resize-none",rows:"3",maxLength:"200"})]}),(0,Su.jsxs)("div",{className:"settings-section",children:[(0,Su.jsx)("h3",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Change Password"}),(0,Su.jsx)("input",{type:"password",placeholder:"Current Password",value:s.currentPassword,onChange:e=>o((t=>u(u({},t),{},{currentPassword:e.target.value}))),className:"form-input form-input-animated w-full p-3 rounded mb-4"}),(0,Su.jsx)("input",{type:"password",placeholder:"New Password",value:s.newPassword,onChange:e=>o((t=>u(u({},t),{},{newPassword:e.target.value}))),className:"form-input form-input-animated w-full p-3 rounded mb-4"}),(0,Su.jsx)("input",{type:"password",placeholder:"Confirm New Password",value:s.confirmPassword,onChange:e=>o((t=>u(u({},t),{},{confirmPassword:e.target.value}))),className:"form-input form-input-animated w-full p-3 rounded"})]}),(0,Su.jsxs)("div",{className:"flex space-x-4 mt-6",children:[(0,Su.jsx)("button",{onClick:async()=>{if(s.newPassword&&s.newPassword!==s.confirmPassword)alert("New passwords do not match");else try{const e={user_id:i.id,username:s.username,bio:s.bio,profile_picture:s.profilePicture};s.currentPassword&&s.newPassword&&(e.current_password=s.currentPassword,e.new_password=s.newPassword);const t=await kt.put("".concat(zv,"/users/update"),e);a(t.data.user),alert("Settings updated successfully!"),n()}catch(r){var e,t;console.error("Failed to update settings:",r),alert((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to update settings")}},className:"btn-enhanced flex-1 py-3 rounded-lg font-semibold",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:"Save Changes"}),(0,Su.jsx)("button",{onClick:n,className:"btn-enhanced flex-1 py-3 rounded-lg font-semibold",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:"Cancel"})]})]})}):null},qv=e=>{let{notifications:t,onRemove:n}=e;return(0,Su.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map((e=>(0,Su.jsx)("div",{className:"notification-box p-4 rounded-lg shadow-lg transform transition-all duration-300 ease-in-out animate-slideInRight cursor-pointer min-w-[300px] max-w-[400px] ".concat("success"===e.type?"bg-gradient-to-r from-green-500 to-green-600 text-white":"error"===e.type?"bg-gradient-to-r from-red-500 to-red-600 text-white":"bg-gradient-to-r from-blue-500 to-blue-600 text-white"),onClick:()=>n(e.id),children:(0,Su.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,Su.jsxs)("div",{className:"flex-shrink-0 mt-0.5",children:["success"===e.type&&(0,Su.jsx)("span",{className:"text-lg",children:"\u2705"}),"error"===e.type&&(0,Su.jsx)("span",{className:"text-lg",children:"\u274c"}),"info"===e.type&&(0,Su.jsx)("span",{className:"text-lg",children:"\u2139\ufe0f"})]}),(0,Su.jsx)("div",{className:"flex-1",children:(0,Su.jsx)("p",{className:"text-sm font-medium leading-5",children:e.message})}),(0,Su.jsx)("button",{onClick:t=>{t.stopPropagation(),n(e.id)},className:"flex-shrink-0 text-white/80 hover:text-white transition-colors",children:"\u2715"})]})},e.id)))})};function Yv(){const{darkMode:e}=Uv(),[t,n]=(0,r.useState)(null),[i,a]=(0,r.useState)([]),[s,o]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),[d,h]=(0,r.useState)([]),[f,p]=(0,r.useState)([]),[m,g]=(0,r.useState)([]),[v,_]=(0,r.useState)(null),[x,y]=(0,r.useState)(!1),[b,S]=(0,r.useState)("dashboard"),[w,M]=(0,r.useState)("login"),[E,T]=(0,r.useState)({username:"",password:""}),[A,C]=(0,r.useState)({title:"",description:""}),[R,P]=(0,r.useState)({title:"",description:"",tags:[],dayOfWeek:0}),[N,L]=(0,r.useState)({active_users_count:0,social_multiplier:1,credits_per_hour:30}),[k,D]=(0,r.useState)(null),[O,I]=(0,r.useState)(!1),[U,F]=(0,r.useState)(!1),[z,B]=(0,r.useState)({}),[V,H]=(0,r.useState)(null),[j,W]=(0,r.useState)(0),[G,X]=(0,r.useState)(null),[q,Y]=(0,r.useState)(!1),[K,$]=(0,r.useState)(null),[Z,J]=(0,r.useState)([]),[Q,ee]=(0,r.useState)({duration:30,timeLeft:1800,isRunning:!1,isSet:!1}),[te,ne]=(0,r.useState)([]),ie=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";const n=Date.now()+Math.random(),i={id:n,message:e,type:t};J((e=>[...e,i])),setTimeout((()=>{J((e=>e.filter((e=>e.id!==n))))}),4e3)},re=()=>{ee((e=>u(u({},e),{},{timeLeft:60*e.duration,isRunning:!1,isSet:!1})))};(0,r.useEffect)((()=>{let e=null;return Q.isRunning&&Q.timeLeft>0?e=setInterval((()=>{ee((e=>{if(e.timeLeft<=1){return new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBWgcLbcmWwFcTCcbJOIFdQFpQyoT").play().catch((e=>console.log("Audio play failed:",e))),ie("\u23f0 Timer finished! Time to take a break.","success"),u(u({},e),{},{timeLeft:0,isRunning:!1})}return u(u({},e),{},{timeLeft:e.timeLeft-1})}))}),1e3):Q.isRunning||clearInterval(e),()=>clearInterval(e)}),[Q.isRunning,Q.timeLeft]);const ae=e=>{try{localStorage.setItem("relvl_user",JSON.stringify(e)),localStorage.setItem("relvl_login_timestamp",Date.now().toString()),console.log("User session saved to localStorage")}catch(t){console.error("Failed to save user session:",t)}},se=e=>{n(e),ae(e)},oe=()=>{try{localStorage.removeItem("relvl_user"),localStorage.removeItem("relvl_login_timestamp"),console.log("User session cleared from localStorage")}catch(e){console.error("Failed to clear user session:",e)}};(0,r.useEffect)((()=>{const e=e=>{if(v&&t)return navigator.sendBeacon("".concat(zv,"/focus/end"),JSON.stringify({user_id:t.id})),e.preventDefault(),e.returnValue="You have an active focus session. Your session will be saved automatically.",e.returnValue};return v&&window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[v,t]),(0,r.useEffect)((()=>{(async()=>{await(async()=>{try{const t=localStorage.getItem("relvl_user"),i=localStorage.getItem("relvl_login_timestamp");if(t&&i){if(Date.now()-parseInt(i)<2592e6){const i=JSON.parse(t);try{const e=(await kt.get("".concat(zv,"/users/").concat(i.id))).data;n(e),ae(e),console.log("User session restored and validated:",e.username),ie("Welcome back, ".concat(e.username,"!"),"success")}catch(e){console.log("Session validation failed, user may no longer exist"),oe(),ie("Previous session expired, please login again","info")}}else oe(),console.log("User session expired, cleared localStorage")}}catch(t){console.error("Failed to restore user session:",t),oe()}})(),await le()})()}),[]),(0,r.useEffect)((()=>{if(t){fe(),pe(),me(),ge(),ve(),ce();const e=setInterval((()=>{de(),ue(),_e(),fe(),pe(),me(),ve(),(()=>{if(t)try{localStorage.setItem("relvl_login_timestamp",Date.now().toString())}catch(e){console.error("Failed to extend user session:",e)}})()}),3e3);return()=>clearInterval(e)}}),[t,j]);const le=async()=>{try{console.log("Initializing app data..."),console.log("API endpoint:","".concat(zv,"/init")),await kt.post("".concat(zv,"/init")),await he(),await me(),await ce(),y(!0),console.log("App initialized successfully")}catch(t){var e;console.error("Failed to initialize:",t),console.error("Error details:",null===(e=t.response)||void 0===e?void 0:e.data),y(!0)}},ce=async()=>{if(t)try{console.log("Checking for active focus session...");const n=(await kt.get("".concat(zv,"/users"))).data.find((e=>e.id===t.id));if(n&&n.current_session_start&&n.is_focusing){console.log("Found active focus session, resuming...");const e=new Date(n.current_session_start),t=new Date,i=Math.floor((t-e)/6e4);_({id:"resumed-session",start_time:n.current_session_start,user_id:n.id,is_active:!0}),ie("Resumed focus session (".concat(i," minutes elapsed)"),"info")}else if(n&&n.current_session_start&&!n.is_focusing){console.log("Found stuck session, ending automatically...");try{const e=await kt.post("".concat(zv,"/focus/end"),{user_id:t.id});ie("Previous session ended: earned ".concat(e.data.credits_earned," FC for ").concat(e.data.duration_minutes," minutes"),"success"),se(u(u({},t),{},{credits:e.data.total_credits,is_focusing:!1,current_session_start:null}))}catch(e){console.error("Failed to end stuck session:",e),ie("Found previous session but failed to end it automatically","error")}}}catch(n){console.error("Failed to check for active session:",n)}},ue=async()=>{try{const e=await kt.get("".concat(zv,"/users"));a(e.data)}catch(e){console.error("Failed to fetch users:",e)}},de=async()=>{try{const e=await kt.get("".concat(zv,"/focus/active"));o(e.data)}catch(e){console.error("Failed to fetch active users:",e)}},he=async()=>{try{const e=await kt.get("".concat(zv,"/shop/items"));c(e.data)}catch(e){console.error("Failed to fetch shop items:",e)}},fe=async()=>{if(t)try{const e=await kt.get("".concat(zv,"/tasks/").concat(t.id));h(e.data)}catch(e){console.error("Failed to fetch tasks:",e)}},pe=async()=>{if(t)try{const e=await kt.get("".concat(zv,"/weekly-tasks/").concat(t.id,"?week_offset=").concat(j));p(e.data)}catch(e){console.error("Failed to fetch weekly tasks:",e)}},me=async()=>{try{const e=await kt.get("".concat(zv,"/focus/social-rate"));L(e.data)}catch(e){console.error("Failed to fetch social rate:",e)}},ge=async()=>{if(t)try{const e=await kt.get("".concat(zv,"/statistics/").concat(t.id));H(e.data)}catch(e){console.error("Failed to fetch statistics:",e)}},ve=async()=>{if(t)try{const e=await kt.get("".concat(zv,"/wheel/status/").concat(t.id));X(e.data)}catch(e){console.error("Failed to fetch wheel status:",e)}},_e=async()=>{if(t)try{const e=await kt.get("".concat(zv,"/notifications/").concat(t.id));g(e.data)}catch(e){console.error("Failed to fetch notifications:",e)}},xe=async e=>{if(e.preventDefault(),E.username.trim()&&E.password.trim())try{console.log("Attempting ".concat(w," with:"),{username:E.username.trim(),endpoint:"".concat(zv,"/auth/").concat("login"===w?"login":"register")});const e="login"===w?"login":"register",t=await kt.post("".concat(zv,"/auth/").concat(e),{username:E.username.trim(),password:E.password});console.log("".concat(w," successful:"),t.data);const i=t.data.user;n(i),ae(i),T({username:"",password:""}),ie("".concat("login"===w?"Logged in":"Registered"," successfully!"),"success");try{await ue()}catch(s){console.error("Failed to fetch users after auth:",s)}try{await _e()}catch(s){console.error("Failed to fetch notifications after auth:",s)}try{await fe()}catch(s){console.error("Failed to fetch tasks after auth:",s)}try{await pe()}catch(s){console.error("Failed to fetch weekly tasks after auth:",s)}}catch(s){var t,i,r,a;console.error("Auth failed:",s),console.error("Error details:",{status:null===(t=s.response)||void 0===t?void 0:t.status,data:null===(i=s.response)||void 0===i?void 0:i.data,message:s.message}),ie((null===(r=s.response)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.detail)||"".concat(w," failed"),"error")}else ie("Please fill in all fields","error")},ye=async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)try{const i=await kt.post("".concat(zv,"/shop/purchase"),{user_id:t.id,item_id:e,target_user_id:n}),r=await kt.get("".concat(zv,"/users/").concat(t.id));se(r.data),await ue(),await _e();let a="Successfully purchased ".concat(i.data.item_name,"!");i.data.requires_consent&&(a+=" Waiting for consent from target user."),alert(a)}catch(a){var i,r;console.error("Failed to purchase item:",a),alert((null===(i=a.response)||void 0===i||null===(r=i.data)||void 0===r?void 0:r.detail)||"Failed to purchase item")}},be=e=>{D(e),I(!0)},Se=e=>{const n=(e=>{switch(e){case"statistics":return{requiredLevel:3,unlocked:(null===t||void 0===t?void 0:t.level)>=3};case"weekly-planner":return{requiredLevel:5,unlocked:(null===t||void 0===t?void 0:t.level)>=5};case"wheel":return{requiredLevel:6,unlocked:(null===t||void 0===t?void 0:t.level)>=6};default:return{requiredLevel:1,unlocked:!0}}})(e);S(e),n.unlocked&&("statistics"===e?ge():"wheel"===e&&ve())},we=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return{responsive:!0,interaction:{intersect:!1,mode:"index"},animation:{duration:2e3,easing:"easeInOutQuart",delay:e=>{let t=0;return"data"===e.type&&"default"===e.mode&&(t=50*e.dataIndex+100*e.datasetIndex),t}},plugins:{legend:{position:"top",labels:{color:"var(--text-primary)",padding:20,font:{size:12,weight:"bold"},usePointStyle:!0,pointStyle:"circle"}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"var(--accent-color)",borderWidth:2,cornerRadius:12,padding:16,boxShadow:"0 10px 30px rgba(0, 0, 0, 0.3)",titleFont:{size:14,weight:"bold"},bodyFont:{size:13},displayColors:!0,callbacks:{label:function(t){return"".concat(t.dataset.label,": ").concat(t.parsed.y).concat("bar"===e?" minutes":"")}}}},scales:{x:{ticks:{color:"var(--text-secondary)",font:{size:11,weight:"500"}},grid:{color:"rgba(100, 100, 100, 0.1)",lineWidth:1,drawBorder:!1},border:{display:!1}},y:{ticks:{color:"var(--text-secondary)",font:{size:11,weight:"500"},callback:function(t){return"bar"===e?t+"m":t}},grid:{color:"rgba(100, 100, 100, 0.1)",lineWidth:1,drawBorder:!1},border:{display:!1},beginAtZero:!0}}}};if(!x)return(0,Su.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:(0,Su.jsxs)("div",{className:"text-xl",children:[(0,Su.jsx)("div",{className:"loading-spinner inline-block mr-3"}),"Initializing RELVL..."]})});if(!t)return(0,Su.jsxs)("div",{className:"min-h-screen flex items-center justify-center login-container",style:{backgroundColor:"var(--bg-primary)"},children:[(0,Su.jsx)(wu,{darkMode:e}),(0,Su.jsx)(Hv,{darkMode:e}),(0,Su.jsx)("div",{className:"absolute top-6 right-6 z-50",children:(0,Su.jsx)(Vv,{})}),(0,Su.jsxs)("div",{className:"login-card p-8 rounded-xl shadow-2xl max-w-md w-full mx-4 relative z-10",children:[(0,Su.jsx)("h1",{className:"login-title text-3xl font-bold text-center mb-2",children:"RELVL"}),(0,Su.jsx)("p",{className:"login-tagline text-center mb-6 opacity-80",children:"Turn focus into currency. Strategy decides who rises."}),(0,Su.jsxs)("div",{className:"auth-toggle flex rounded-lg p-1 mb-6",style:{backgroundColor:"var(--bg-tertiary)"},children:[(0,Su.jsx)("button",{onClick:()=>M("login"),className:"flex-1 py-2 px-4 rounded-md transition-all btn-enhanced ".concat("login"===w?"bg-white text-black":"opacity-70 hover:opacity-100"),children:"Login"}),(0,Su.jsx)("button",{onClick:()=>M("register"),className:"flex-1 py-2 px-4 rounded-md transition-all btn-enhanced ".concat("register"===w?"bg-white text-black":"opacity-70 hover:opacity-100"),children:"Register"})]}),(0,Su.jsxs)("form",{className:"auth-form",onSubmit:xe,children:[(0,Su.jsx)("input",{type:"text",placeholder:"Username",value:E.username,onChange:e=>T(u(u({},E),{},{username:e.target.value})),className:"form-input w-full p-3 rounded mb-4 focus:outline-none",required:!0}),(0,Su.jsx)("input",{type:"password",placeholder:"Password",value:E.password,onChange:e=>T(u(u({},E),{},{password:e.target.value})),className:"form-input w-full p-3 rounded mb-4 focus:outline-none",required:!0}),(0,Su.jsx)("button",{type:"submit",className:"btn-enhanced w-full p-3 rounded font-semibold",style:{backgroundColor:e?"var(--accent-color)":"white",color:e?"var(--bg-primary)":"black"},children:"login"===w?"Enter the Arena":"Join the Battle"})]})]})]});const Me=m.filter((e=>!e.is_read&&e.user_id===t.id));return(0,Su.jsxs)("div",{className:"min-h-screen",style:{backgroundColor:"var(--bg-primary)",color:"var(--text-primary)"},children:[(0,Su.jsx)(qv,{notifications:Z,onRemove:e=>{J((t=>t.filter((t=>t.id!==e))))}}),(0,Su.jsx)("header",{className:"header-container p-4",children:(0,Su.jsxs)("div",{className:"max-w-6xl mx-auto flex justify-between items-center",children:[(0,Su.jsx)("h1",{className:"text-2xl font-bold",children:"RELVL"}),(0,Su.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,Su.jsxs)("div",{className:"text-right",children:[(0,Su.jsxs)("div",{className:"text-lg font-semibold flex items-center",children:[(0,Su.jsx)("span",{className:"clickable-username",onClick:()=>be(t),children:t.username}),t.level>1&&(0,Su.jsxs)("span",{className:"ml-2 bg-yellow-500 text-black px-2 py-1 rounded-full text-xs font-bold",children:["L",t.level]})]}),(0,Su.jsxs)("div",{className:"opacity-80",children:[t.credits," FC"]}),(0,Su.jsxs)("div",{className:"text-sm opacity-70",children:["Effective Rate: ",(N.social_multiplier*t.credit_rate_multiplier).toFixed(1),"x"]}),(0,Su.jsxs)("div",{className:"text-xs opacity-60",children:["Social: ",N.social_multiplier.toFixed(1),"x \u2022 Personal: ",t.credit_rate_multiplier.toFixed(1),"x"]})]}),Me.length>0&&(0,Su.jsx)("div",{className:"notification-badge bg-red-500 text-white px-2 py-1 rounded-full text-xs",children:Me.length}),(0,Su.jsx)("button",{onClick:()=>F(!0),className:"btn-enhanced px-3 py-1 rounded",style:{backgroundColor:"var(--bg-tertiary)"},title:"Settings",children:"\u2699\ufe0f"}),(0,Su.jsx)(Vv,{}),(0,Su.jsx)("button",{onClick:()=>{n(null),T({username:"",password:""}),_(null),S("dashboard"),oe(),ie("Logged out successfully","info")},className:"btn-enhanced px-3 py-1 rounded",style:{backgroundColor:"var(--bg-tertiary)"},title:"Logout",children:"Logout"})]})]})}),(0,Su.jsx)("nav",{className:"nav-container border-b",children:(0,Su.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,Su.jsx)("div",{className:"flex space-x-8",children:[{id:"dashboard",label:"Dashboard",requiredLevel:1},{id:"shop",label:"Shop",requiredLevel:1},{id:"tasks",label:"Tasks",requiredLevel:1},{id:"statistics",label:"Statistics",requiredLevel:3},{id:"weekly-planner",label:"Weekly Planner",requiredLevel:5},{id:"wheel",label:"Daily Wheel",requiredLevel:6},{id:"leaderboard",label:"Leaderboard",requiredLevel:1},{id:"activity",label:"Activity",requiredLevel:1}].map((e=>{const n=t.level>=e.requiredLevel;return(0,Su.jsxs)("button",{onClick:()=>Se(e.id),className:"nav-tab nav-tab-animated py-3 px-4 border-b-2 transition-all capitalize relative ".concat(b===e.id?"active border-black font-semibold":"border-transparent opacity-70 hover:opacity-100"," ").concat(n?"":"locked-tab"),style:{borderColor:b===e.id?"var(--accent-color)":"transparent",color:n?"var(--text-primary)":"var(--text-muted)",cursor:n?"pointer":"not-allowed"},children:[e.label,!n&&(0,Su.jsx)("span",{className:"ml-1 text-xs",children:"\ud83d\udd12"})]},e.id)}))})})}),(0,Su.jsxs)("div",{className:"max-w-6xl mx-auto p-6",children:["dashboard"===b&&(0,Su.jsxs)("div",{className:"space-y-6",children:[(0,Su.jsxs)("div",{className:"focus-timer-container card-enhanced p-6 rounded-lg ".concat(v?"focus-session-active":"focus-session-inactive"),children:[(0,Su.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Focus Session"}),v?(0,Su.jsxs)("div",{className:"text-center",children:[(0,Su.jsxs)("div",{className:"p-4 rounded-lg mb-4",style:{backgroundColor:"rgba(16, 185, 129, 0.2)",border:"2px solid #10b981"},children:[(0,Su.jsx)("div",{className:"text-2xl font-bold text-green-800 mb-2",children:"FOCUSING"}),(0,Su.jsxs)("div",{className:"text-green-700",children:["Started at ",new Date(v.start_time).toLocaleTimeString()]}),(0,Su.jsxs)("div",{className:"text-sm text-green-600 mt-2",children:["Earning ",(N.social_multiplier*t.credit_rate_multiplier*30).toFixed(1)," FC per hour"]}),(0,Su.jsxs)("div",{className:"text-xs text-green-600",children:["Social: ",N.social_multiplier.toFixed(1),"x \u2022 Personal: ",t.credit_rate_multiplier.toFixed(1),"x"]})]}),(0,Su.jsxs)("div",{className:"timer-container",children:[(0,Su.jsx)("h3",{className:"text-lg font-semibold mb-3",style:{color:"var(--text-primary)"},children:"Focus Timer"}),(0,Su.jsx)("div",{className:"timer-duration-selector",children:[10,20,30,45,60,90,120,180,240].map((e=>(0,Su.jsx)("button",{onClick:()=>(e=>{ee((t=>u(u({},t),{},{duration:e,timeLeft:60*e,isRunning:!1,isSet:!1})))})(e),className:"timer-duration-btn ".concat(Q.duration===e?"active":""),disabled:Q.isRunning,children:e>=60?"".concat(Math.floor(e/60),"h").concat(e%60?" ".concat(e%60,"m"):""):"".concat(e,"m")},e)))}),(0,Su.jsx)("div",{className:"timer-display",children:(e=>{const t=Math.floor(e/60),n=e%60;return"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))})(Q.timeLeft)}),(0,Su.jsxs)("div",{className:"timer-controls",children:[Q.isRunning?(0,Su.jsx)("button",{onClick:()=>{ee((e=>u(u({},e),{},{isRunning:!1})))},className:"timer-btn pause",children:"\u23f8\ufe0f Pause"}):(0,Su.jsxs)("button",{onClick:()=>{ee((e=>u(u({},e),{},{isRunning:!0,isSet:!0})))},className:"timer-btn start",disabled:0===Q.timeLeft,children:["\u25b6\ufe0f ",Q.isSet?"Resume":"Start"]}),(0,Su.jsx)("button",{onClick:re,className:"timer-btn reset",disabled:!Q.isSet,children:"\ud83d\udd04 Reset"})]}),(0,Su.jsx)("div",{className:"text-xs mt-2 opacity-70",style:{color:"var(--text-secondary)"},children:Q.isRunning?"\ud83d\udfe2 Timer is running":Q.isSet?"\u23f8\ufe0f Timer is paused":"\u23f1\ufe0f Set a timer to stay focused"})]}),(0,Su.jsx)("button",{onClick:async()=>{if(t)try{const e=await kt.post("".concat(zv,"/focus/end"),{user_id:t.id});_(null),re();const n=await kt.get("".concat(zv,"/users/").concat(t.id));se(n.data),await de(),await ue(),await ge(),ie("Session ended! You earned ".concat(e.data.credits_earned," credits in ").concat(e.data.duration_minutes," minutes (Rate: ").concat(e.data.effective_rate.toFixed(1),"x)."),"success")}catch(i){var e,n;console.error("Failed to end focus session:",i),ie((null===(e=i.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||"Failed to end focus session","error")}},className:"btn-enhanced bg-red-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-red-700 mt-4",children:"End Session"})]}):(0,Su.jsxs)("div",{className:"text-center",children:[(0,Su.jsx)("p",{className:"mb-2 opacity-80",children:"Ready to earn some Focus Credits (FC)?"}),(0,Su.jsxs)("div",{className:"card-enhanced p-3 mb-4",style:{backgroundColor:"var(--bg-tertiary)"},children:[(0,Su.jsxs)("div",{className:"font-semibold mb-1 focus-credits-animation",children:["Social Rate: ",N.social_multiplier.toFixed(1),"x (",N.credits_per_hour," FC/hour)"]}),(0,Su.jsxs)("div",{className:"text-xs opacity-70",children:[N.active_users_count," users focusing = ",N.social_multiplier.toFixed(1),"x multiplier"]}),(0,Su.jsxs)("div",{className:"text-xs opacity-70 mt-1",children:["Your personal rate: ",(N.social_multiplier*t.credit_rate_multiplier).toFixed(1),"x"]})]}),(0,Su.jsx)("button",{onClick:async()=>{if(t)try{const e=await kt.post("".concat(zv,"/focus/start"),{user_id:t.id});_(e.data),re(),await de()}catch(i){var e,n;console.error("Failed to start focus session:",i),ie((null===(e=i.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||"Failed to start focus session","error")}},className:"btn-enhanced px-8 py-3 rounded-lg font-semibold",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:"Start Focus Session"})]})]}),(0,Su.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{label:"Focus Credits",value:t.credits},{label:"Focus Minutes",value:t.total_focus_time},{label:"Credit Rate",value:"".concat(t.credit_rate_multiplier.toFixed(1),"x")},{label:"Tasks Done",value:t.completed_tasks}].map(((e,t)=>(0,Su.jsxs)("div",{className:"stats-card card-enhanced p-4 rounded-lg text-center",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:[(0,Su.jsx)("div",{className:"text-2xl font-bold",children:e.value}),(0,Su.jsx)("div",{className:"opacity-80",children:e.label})]},t)))}),s.length>0&&(0,Su.jsxs)("div",{className:"card-enhanced p-6 rounded-lg",children:[(0,Su.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Currently Focusing"}),(0,Su.jsx)("div",{className:"space-y-2",children:s.map(((e,t)=>(0,Su.jsxs)("div",{className:"active-user-item activity-item flex justify-between items-center p-3 rounded",style:{animationDelay:"".concat(.1*t,"s")},children:[(0,Su.jsxs)("span",{className:"font-medium flex items-center",children:[(0,Su.jsx)("span",{className:"clickable-username",onClick:()=>be(e),children:e.username}),e.level>1&&(0,Su.jsxs)("span",{className:"ml-2 bg-yellow-400 text-black px-1.5 py-0.5 rounded text-xs",children:["L",e.level]})]}),(0,Su.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Su.jsxs)("span",{className:"text-sm opacity-70",children:[e.credits," FC"]}),(0,Su.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"})]})]},e.id)))})]})]}),"shop"===b&&(0,Su.jsxs)("div",{className:"space-y-6",children:[(0,Su.jsxs)("div",{className:"text-center mb-6",children:[(0,Su.jsx)("h2",{className:"text-2xl font-bold",children:"Strategic Arsenal"}),(0,Su.jsx)("p",{className:"opacity-70",children:"Boost yourself or target others with passes"})]}),(0,Su.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(((e,n)=>(0,Su.jsxs)("div",{className:"shop-item-animated card-enhanced rounded-lg p-6 ".concat("sabotage"===e.item_type?"shop-item-sabotage":"special"===e.item_type?"shop-item-special":"defensive"===e.item_type?"shop-item-defensive":"shop-item-boost"),style:{animationDelay:"".concat(.1*n,"s")},children:[(0,Su.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,Su.jsxs)("h3",{className:"text-lg font-bold flex items-center",children:[(0,Su.jsx)("span",{className:"text-2xl mr-2",children:e.emoji}),e.name]}),(0,Su.jsxs)("div",{className:"px-3 py-1 rounded text-sm font-semibold text-white ".concat("sabotage"===e.item_type?"bg-red-600":"special"===e.item_type?"bg-blue-600":"defensive"===e.item_type?"bg-purple-600":"bg-green-600"),children:[e.price," FC"]})]}),(0,Su.jsx)("p",{className:"opacity-80 mb-4 text-sm",children:e.description}),e.requires_target?(0,Su.jsxs)("div",{children:[(0,Su.jsx)(Wv,{item:e,users:i,currentUser:t,selectedUserId:z[e.id],onSelectUser:t=>{B((n=>u(u({},n),{},{[e.id]:t})))}}),(0,Su.jsx)("button",{onClick:()=>{const t=z[e.id];t?(ye(e.id,t),B((t=>u(u({},t),{},{[e.id]:null})))):alert("Please select a target user")},disabled:t.credits<e.price||!z[e.id],className:"btn-enhanced w-full py-3 px-4 rounded-lg font-semibold text-white transition-all duration-300 ".concat(t.credits<e.price||!z[e.id]?"bg-gray-400 cursor-not-allowed opacity-60":"sabotage"===e.item_type?"bg-red-600 hover:bg-red-700 hover:scale-105":"bg-blue-600 hover:bg-blue-700 hover:scale-105"),children:t.credits<e.price?"Insufficient FC":z[e.id]?"Use Pass":"Select Target"})]}):(0,Su.jsx)("button",{onClick:()=>ye(e.id),disabled:t.credits<e.price,className:"btn-enhanced w-full py-2 px-4 rounded font-semibold text-white ".concat(t.credits<e.price?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),children:t.credits<e.price?"Insufficient FC":"Purchase"})]},e.id)))})]}),"tasks"===b&&(0,Su.jsxs)("div",{className:"space-y-6",children:[(0,Su.jsxs)("div",{className:"text-center mb-6",children:[(0,Su.jsx)("h2",{className:"text-2xl font-bold",children:"Personal Tasks"}),(0,Su.jsx)("p",{className:"opacity-70",children:"Create and complete your own tasks to earn 10 FC each"})]}),(0,Su.jsxs)("div",{className:"form-animated card-enhanced p-6 rounded-lg",children:[(0,Su.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Create New Task"}),(0,Su.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),A.title.trim())try{await(async(e,n)=>{if(t)try{const i=await kt.post("".concat(zv,"/tasks"),{user_id:t.id,title:e.trim(),description:n.trim()});return await fe(),i.data}catch(i){throw console.error("Failed to create task:",i),i}})(A.title,A.description),C({title:"",description:""}),ie("Task created successfully!","success")}catch(r){var n,i;console.error("Failed to create task:",r),ie((null===(n=r.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.detail)||"Failed to create task","error")}else ie("Please enter a task title","error")},className:"space-y-4",children:[(0,Su.jsx)("input",{type:"text",placeholder:"Task title (e.g., Read for 30 minutes)",value:A.title,onChange:e=>C(u(u({},A),{},{title:e.target.value})),className:"form-input form-input-animated w-full p-3 rounded focus:outline-none",maxLength:100}),(0,Su.jsx)("textarea",{placeholder:"Task description (optional)",value:A.description,onChange:e=>C(u(u({},A),{},{description:e.target.value})),className:"form-input form-input-animated w-full p-3 rounded focus:outline-none resize-none",rows:"3",maxLength:300}),(0,Su.jsx)("button",{type:"submit",className:"btn-enhanced px-6 py-2 rounded-lg font-semibold",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:"Create Task"})]})]}),(0,Su.jsxs)("div",{children:[(0,Su.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Your Active Tasks"}),0===d.length?(0,Su.jsx)("div",{className:"text-center py-8 opacity-70",children:(0,Su.jsx)("p",{children:"No tasks yet. Create your first task above!"})}):(0,Su.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(((e,n)=>(0,Su.jsxs)("div",{className:"task-card card-enhanced p-6 rounded-lg",style:{animationDelay:"".concat(.1*n,"s")},children:[(0,Su.jsx)("h4",{className:"text-lg font-bold mb-2",children:e.title}),e.description&&(0,Su.jsx)("p",{className:"opacity-70 mb-4 text-sm",children:e.description}),(0,Su.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Su.jsxs)("span",{className:"text-green-600 font-semibold",children:["+",e.credits_reward," FC"]}),(0,Su.jsx)("button",{onClick:()=>(async e=>{if(t)try{const n=await kt.post("".concat(zv,"/tasks/complete"),{user_id:t.id,task_id:e}),i=await kt.get("".concat(zv,"/users/").concat(t.id));se(i.data),await ue(),await _e(),ie("Task completed! You earned ".concat(n.data.credits_earned," credits."),"success")}catch(r){var n,i;console.error("Failed to complete task:",r),ie((null===(n=r.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.detail)||"Failed to complete task","error")}})(e.id),className:"task-complete-btn bg-green-600 text-white px-4 py-2 rounded font-semibold hover:bg-green-700",children:"Complete"})]})]},e.id)))})]})]}),"statistics"===b&&(t.level>=3?(0,Su.jsxs)("div",{className:"space-y-6",children:[(0,Su.jsxs)("div",{className:"text-center mb-6",children:[(0,Su.jsx)("h2",{className:"text-2xl font-bold",children:"Study Statistics"}),(0,Su.jsx)("p",{className:"opacity-70",children:"Your focus and productivity insights"})]}),V&&(0,Su.jsxs)(Su.Fragment,{children:[(0,Su.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[{label:"Total Focus Time",value:"".concat(V.user_stats.total_focus_time," min")},{label:"Total Credits",value:V.user_stats.total_credits},{label:"Tasks Completed",value:V.user_stats.total_tasks_completed},{label:"Current Level",value:V.user_stats.current_level}].map(((e,t)=>(0,Su.jsxs)("div",{className:"stats-card card-enhanced p-4 rounded-lg text-center",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:[(0,Su.jsx)("div",{className:"text-2xl font-bold",children:e.value}),(0,Su.jsx)("div",{className:"opacity-80",children:e.label})]},t)))}),(0,Su.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Su.jsxs)("div",{className:"card-enhanced p-6 rounded-lg chart-glow",children:[(0,Su.jsx)("h3",{className:"text-lg font-bold mb-4 chart-title",children:"\ud83d\udcca Daily Focus Time (Last 7 Days)"}),(0,Su.jsx)("div",{className:"chart-container",children:(0,Su.jsx)(Dv,{data:{labels:Object.keys(V.daily_focus_time).slice(-7),datasets:[{label:"Minutes Focused",data:Object.values(V.daily_focus_time).slice(-7),backgroundColor:e=>{const t=e.chart,{ctx:n,chartArea:i}=t;return i?((e,t)=>{if(!t)return null;const n=e.createLinearGradient(0,t.bottom,0,t.top);return n.addColorStop(0,"rgba(59, 130, 246, 0.1)"),n.addColorStop(.5,"rgba(59, 130, 246, 0.6)"),n.addColorStop(1,"rgba(59, 130, 246, 1)"),n})(n,i):"rgba(59, 130, 246, 0.8)"},borderColor:"rgba(59, 130, 246, 1)",borderWidth:2,borderRadius:8,borderSkipped:!1,hoverBackgroundColor:"rgba(59, 130, 246, 0.9)",hoverBorderColor:"rgba(37, 99, 235, 1)",hoverBorderWidth:3,shadowColor:"rgba(59, 130, 246, 0.5)",shadowBlur:15,shadowOffsetX:0,shadowOffsetY:8}]},options:u(u({},we("bar")),{},{plugins:u(u({},we("bar").plugins),{},{beforeDraw:e=>{const t=e.ctx;t.save(),t.shadowColor="rgba(59, 130, 246, 0.3)",t.shadowBlur=20,t.shadowOffsetX=2,t.shadowOffsetY=4}})})})})]}),(0,Su.jsxs)("div",{className:"card-enhanced p-6 rounded-lg",children:[(0,Su.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Task Completion Breakdown"}),(0,Su.jsx)("div",{className:"chart-container",children:(0,Su.jsx)(Ov,{data:{labels:["Regular Tasks","Weekly Tasks"],datasets:[{data:[V.user_stats.regular_tasks_completed,V.user_stats.weekly_tasks_completed],backgroundColor:["rgba(34, 197, 94, 0.8)","rgba(168, 85, 247, 0.8)"],borderColor:["rgba(34, 197, 94, 1)","rgba(168, 85, 247, 1)"],borderWidth:2}]},options:{responsive:!0,plugins:{legend:{position:"bottom",labels:{color:"var(--text-primary)"}},tooltip:{backgroundColor:"var(--bg-secondary)",titleColor:"var(--text-primary)",bodyColor:"var(--text-primary)",borderColor:"var(--border-color)",borderWidth:1}}}})})]}),(0,Su.jsxs)("div",{className:"card-enhanced p-6 rounded-lg",children:[(0,Su.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Weekly Progress"}),(0,Su.jsx)("div",{className:"chart-container",children:(0,Su.jsx)(kv,{data:{labels:V.weekly_breakdown.map((e=>new Date(e.week_start).toLocaleDateString())),datasets:[{label:"Focus Minutes",data:V.weekly_breakdown.map((e=>e.focus_minutes)),borderColor:"rgba(34, 197, 94, 1)",backgroundColor:"rgba(34, 197, 94, 0.1)",fill:!0,tension:.4},{label:"Credits Earned",data:V.weekly_breakdown.map((e=>e.credits_earned)),borderColor:"rgba(59, 130, 246, 1)",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.4}]},options:we()})})]}),(0,Su.jsxs)("div",{className:"card-enhanced p-6 rounded-lg",children:[(0,Su.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Daily Credits Earned"}),(0,Su.jsx)("div",{className:"chart-container",children:(0,Su.jsx)(Dv,{data:{labels:Object.keys(V.daily_credits).slice(-7),datasets:[{label:"Credits Earned",data:Object.values(V.daily_credits).slice(-7),backgroundColor:"rgba(168, 85, 247, 0.8)",borderColor:"rgba(168, 85, 247, 1)",borderWidth:1}]},options:we()})})]})]})]})]}):(0,Su.jsx)(jv,{requiredLevel:3})),"weekly-planner"===b&&(t.level>=5?(0,Su.jsxs)("div",{className:"space-y-6",children:[(0,Su.jsxs)("div",{className:"text-center mb-6",children:[(0,Su.jsx)("h2",{className:"text-2xl font-bold",children:"Weekly Planner"}),(0,Su.jsx)("p",{className:"opacity-70",children:"Plan your tasks for each day of the week"})]}),(0,Su.jsxs)("div",{className:"flex justify-center items-center space-x-4 mb-6",children:[(0,Su.jsx)("button",{onClick:()=>W(j-1),className:"btn-enhanced px-4 py-2 rounded",style:{backgroundColor:"var(--bg-tertiary)"},children:"\u2190 Previous Week"}),(0,Su.jsx)("span",{className:"font-semibold",children:0===j?"Current Week":j>0?"".concat(j," week").concat(j>1?"s":""," ahead"):"".concat(Math.abs(j)," week").concat(Math.abs(j)>1?"s":""," ago")}),(0,Su.jsx)("button",{onClick:()=>W(j+1),className:"btn-enhanced px-4 py-2 rounded",style:{backgroundColor:"var(--bg-tertiary)"},children:"Next Week \u2192"})]}),(0,Su.jsxs)("div",{className:"form-animated card-enhanced p-6 rounded-lg",children:[(0,Su.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Add New Weekly Task"}),(0,Su.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),R.title.trim())try{await(async(e,n,i,r)=>{if(t)try{const a=await kt.post("".concat(zv,"/weekly-tasks"),{user_id:t.id,title:e.trim(),description:n.trim(),tags:i,day_of_week:r});return await pe(),a.data}catch(a){throw console.error("Failed to create weekly task:",a),a}})(R.title,R.description,R.tags,R.dayOfWeek),P({title:"",description:"",tags:[],dayOfWeek:0}),alert("Weekly task created successfully!")}catch(r){var n,i;console.error("Failed to create weekly task:",r),alert((null===(n=r.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.detail)||"Failed to create weekly task")}else alert("Please enter a task title")},className:"space-y-4",children:[(0,Su.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Su.jsx)("input",{type:"text",placeholder:"Task title",value:R.title,onChange:e=>P(u(u({},R),{},{title:e.target.value})),className:"form-input form-input-animated w-full p-3 rounded focus:outline-none",maxLength:100}),(0,Su.jsxs)("select",{value:R.dayOfWeek,onChange:e=>P(u(u({},R),{},{dayOfWeek:parseInt(e.target.value)})),className:"form-input form-input-animated w-full p-3 rounded focus:outline-none",children:[(0,Su.jsx)("option",{value:0,children:"Monday"}),(0,Su.jsx)("option",{value:1,children:"Tuesday"}),(0,Su.jsx)("option",{value:2,children:"Wednesday"}),(0,Su.jsx)("option",{value:3,children:"Thursday"}),(0,Su.jsx)("option",{value:4,children:"Friday"}),(0,Su.jsx)("option",{value:5,children:"Saturday"}),(0,Su.jsx)("option",{value:6,children:"Sunday"})]})]}),(0,Su.jsx)("textarea",{placeholder:"Task description (optional)",value:R.description,onChange:e=>P(u(u({},R),{},{description:e.target.value})),className:"form-input form-input-animated w-full p-3 rounded focus:outline-none resize-none",rows:"3",maxLength:300}),(0,Su.jsx)("input",{type:"text",placeholder:"Tags (comma-separated, optional)",value:R.tags.join(", "),onChange:e=>P(u(u({},R),{},{tags:e.target.value.split(",").map((e=>e.trim())).filter((e=>e))})),className:"form-input form-input-animated w-full p-3 rounded focus:outline-none"}),(0,Su.jsx)("button",{type:"submit",className:"btn-enhanced px-6 py-2 rounded-lg font-semibold",style:{backgroundColor:"var(--accent-color)",color:"var(--bg-primary)"},children:"Add Task"})]})]}),(0,Su.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-4",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(((e,n)=>{const i=f.filter((e=>e.day_of_week===n));return(0,Su.jsxs)("div",{className:"card-enhanced p-4 rounded-lg",children:[(0,Su.jsx)("h3",{className:"font-bold mb-3 text-center",style:{color:"var(--accent-color)"},children:e}),(0,Su.jsx)("div",{className:"space-y-2",children:0===i.length?(0,Su.jsx)("p",{className:"text-center text-sm opacity-60",children:"No tasks"}):i.map(((e,n)=>(0,Su.jsxs)("div",{className:"task-card p-3 rounded text-sm border ".concat(e.is_completed?"opacity-60 line-through":""),style:{borderColor:"var(--border-color)"},children:[(0,Su.jsx)("div",{className:"font-semibold mb-1",children:e.title}),e.description&&(0,Su.jsx)("div",{className:"opacity-70 mb-2 text-xs",children:e.description}),e.tags.length>0&&(0,Su.jsx)("div",{className:"flex flex-wrap gap-1 mb-2",children:e.tags.map(((e,t)=>(0,Su.jsx)("span",{className:"bg-blue-500 text-white px-1 py-0.5 rounded text-xs",children:e},t)))}),(0,Su.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Su.jsx)("span",{className:"text-green-600 font-semibold text-xs",children:"+10 FC"}),(0,Su.jsxs)("div",{className:"flex space-x-1",children:[e.is_completed?(0,Su.jsx)("span",{className:"text-green-600 text-xs",children:"\u2713 Done"}):(0,Su.jsx)("button",{onClick:()=>(async e=>{if(t)try{const n=await kt.post("".concat(zv,"/weekly-tasks/complete"),{user_id:t.id,task_id:e}),i=await kt.get("".concat(zv,"/users/").concat(t.id));se(i.data),await ue(),await pe(),alert("Weekly task completed! You earned ".concat(n.data.credits_earned," credits."))}catch(r){var n,i;console.error("Failed to complete weekly task:",r),alert((null===(n=r.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.detail)||"Failed to complete weekly task")}})(e.id),className:"bg-green-600 text-white px-2 py-1 rounded text-xs hover:bg-green-700",children:"\u2713"}),(0,Su.jsx)("button",{onClick:()=>(async e=>{if(t)try{await kt.delete("".concat(zv,"/weekly-tasks/").concat(e,"?user_id=").concat(t.id)),await pe()}catch(r){var n,i;console.error("Failed to delete weekly task:",r),alert((null===(n=r.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.detail)||"Failed to delete weekly task")}})(e.id),className:"bg-red-600 text-white px-2 py-1 rounded text-xs hover:bg-red-700",children:"\xd7"})]})]})]},e.id)))})]},e)}))})]}):(0,Su.jsx)(jv,{requiredLevel:5})),"wheel"===b&&(t.level>=6?(0,Su.jsxs)("div",{className:"space-y-6",children:[(0,Su.jsxs)("div",{className:"text-center mb-6",children:[(0,Su.jsx)("h2",{className:"text-2xl font-bold",children:"\ud83c\udfb0 Daily Wheel"}),(0,Su.jsx)("p",{className:"opacity-70",children:"Spin the wheel once per day to earn 10-100 FC!"})]}),(0,Su.jsx)("div",{className:"max-w-md mx-auto",children:(0,Su.jsxs)("div",{className:"card-enhanced p-8 rounded-lg text-center",children:[(0,Su.jsx)("div",{className:"relative mx-auto mb-6",style:{width:"200px",height:"200px"},children:(0,Su.jsxs)("div",{className:"wheel-spinner ".concat(q?"spinning":""),style:{width:"100%",height:"100%",borderRadius:"50%",background:"conic-gradient(from 0deg, #ff6b6b 0deg 45deg, #4ecdc4 45deg 90deg, #45b7d1 90deg 135deg, #96ceb4 135deg 180deg, #feca57 180deg 225deg, #ff9ff3 225deg 270deg, #54a0ff 270deg 315deg, #5f27cd 315deg 360deg)",border:"4px solid var(--accent-color)",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,Su.jsx)("div",{className:"text-white font-bold text-lg",children:"\ud83c\udfb0"}),(0,Su.jsx)("div",{style:{position:"absolute",top:"-10px",left:"50%",transform:"translateX(-50%)",width:"0",height:"0",borderLeft:"10px solid transparent",borderRight:"10px solid transparent",borderBottom:"15px solid var(--accent-color)",zIndex:10}})]})}),(0,Su.jsx)("div",{className:"mb-6",children:null!==G&&void 0!==G&&G.can_spin?(0,Su.jsx)("div",{className:"text-green-500 font-semibold",children:"\u2705 Ready to spin!"}):"already_spun_today"===(null===G||void 0===G?void 0:G.reason)?(0,Su.jsxs)("div",{className:"text-orange-500",children:[(0,Su.jsx)("div",{className:"font-semibold",children:"Already spun today!"}),(0,Su.jsxs)("div",{className:"text-sm mt-1",children:["Next spin: ",new Date(G.next_spin_available).toLocaleString()]})]}):"requires_level_6"===(null===G||void 0===G?void 0:G.reason)?(0,Su.jsxs)("div",{className:"text-red-500",children:[(0,Su.jsx)("div",{className:"font-semibold",children:"Requires Level 6"}),(0,Su.jsxs)("div",{className:"text-sm mt-1",children:["Current Level: ",G.user_level]})]}):(0,Su.jsx)("div",{className:"text-gray-500",children:"Loading..."})}),(0,Su.jsx)("button",{onClick:async()=>{if(t&&null!==G&&void 0!==G&&G.can_spin)try{Y(!0),$(null),setTimeout((async()=>{try{const e=await kt.post("".concat(zv,"/wheel/spin"),{user_id:t.id});$(e.data);const n=await kt.get("".concat(zv,"/users/").concat(t.id));se(n.data),await ve(),await _e()}catch(i){var e,n;console.error("Failed to spin wheel:",i),alert((null===(e=i.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||"Failed to spin wheel")}finally{Y(!1)}}),2e3)}catch(e){console.error("Failed to spin wheel:",e),Y(!1)}},disabled:!(null!==G&&void 0!==G&&G.can_spin)||q,className:"btn-enhanced px-8 py-4 rounded-lg font-bold text-lg transition-all ".concat(null!==G&&void 0!==G&&G.can_spin&&!q?"hover:scale-110 cursor-pointer":"opacity-50 cursor-not-allowed"),style:{backgroundColor:null!==G&&void 0!==G&&G.can_spin&&!q?"var(--accent-color)":"var(--bg-tertiary)",color:null!==G&&void 0!==G&&G.can_spin&&!q?"var(--bg-primary)":"var(--text-muted)"},children:q?"Spinning...":"Spin the Wheel!"}),K&&(0,Su.jsxs)("div",{className:"mt-6 p-4 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[(0,Su.jsx)("div",{className:"text-xl font-bold text-green-500 mb-2",children:"\ud83c\udf89 Congratulations!"}),(0,Su.jsxs)("div",{className:"text-lg",children:["You won ",(0,Su.jsxs)("span",{className:"font-bold text-yellow-500",children:[K.reward," FC"]}),"!"]})]}),(0,Su.jsxs)("div",{className:"mt-8 text-sm opacity-70",children:[(0,Su.jsx)("div",{className:"font-semibold mb-2",children:"Possible Rewards:"}),(0,Su.jsx)("div",{children:"10 FC - 100 FC (Random)"})]})]})})]}):(0,Su.jsx)(jv,{requiredLevel:6})),"leaderboard"===b&&(0,Su.jsxs)("div",{className:"space-y-6",children:[(0,Su.jsx)("h2",{className:"text-2xl font-bold text-center",children:"Leaderboard"}),(0,Su.jsx)("div",{className:"card-enhanced rounded-lg overflow-hidden",children:i.sort(((e,t)=>t.credits-e.credits)).slice(0,10).map(((e,n)=>(0,Su.jsxs)("div",{className:"leaderboard-item flex justify-between items-center p-4 border-b last:border-b-0 ".concat(e.id===t.id?"bg-yellow-100":""," ").concat(0===n?"leaderboard-gold":1===n?"leaderboard-silver":2===n?"leaderboard-bronze":""),children:[(0,Su.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Su.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold ".concat(n<3?"text-white":""),style:{backgroundColor:n>=3?"var(--bg-tertiary)":"transparent",color:n>=3?"var(--text-primary)":"inherit"},children:n+1}),(0,Su.jsxs)("div",{children:[(0,Su.jsxs)("div",{className:"font-semibold flex items-center",children:[(0,Su.jsx)("span",{className:"clickable-username",onClick:()=>be(e),children:e.username}),e.level>1&&(0,Su.jsxs)("span",{className:"ml-2 bg-yellow-400 text-black px-2 py-1 rounded text-xs font-bold",children:["L",e.level]})]}),(0,Su.jsxs)("div",{className:"text-sm opacity-70",children:[e.total_focus_time," min focused \u2022 ",e.credit_rate_multiplier.toFixed(1),"x rate \u2022 ",e.completed_tasks," tasks"]})]})]}),(0,Su.jsxs)("div",{className:"text-right",children:[(0,Su.jsx)("div",{className:"text-xl font-bold",children:e.credits}),(0,Su.jsx)("div",{className:"text-sm opacity-70",children:"FC"})]})]},e.id)))})]}),"activity"===b&&(0,Su.jsxs)("div",{className:"space-y-6",children:[(0,Su.jsx)("h2",{className:"text-2xl font-bold text-center",children:"Activity Feed"}),(0,Su.jsx)("div",{className:"card-enhanced rounded-lg overflow-hidden",children:0===m.length?(0,Su.jsx)("div",{className:"p-8 text-center opacity-70",children:"No recent activity. Start focusing or complete tasks to see updates!"}):m.map(((e,n)=>(0,Su.jsx)("div",{className:"activity-item p-4 border-b last:border-b-0 ".concat(e.user_id!==t.id||e.is_read?"":"bg-yellow-50"),style:{animationDelay:"".concat(.1*n,"s")},children:(0,Su.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Su.jsxs)("div",{children:[(0,Su.jsx)("div",{className:"font-medium ".concat("pass_used"===e.notification_type?"text-red-600":"task_completed"===e.notification_type?"text-green-600":"ally_formed"===e.notification_type?"text-blue-600":""),style:{color:"var(--text-primary)"},children:e.message}),(0,Su.jsx)("div",{className:"text-xs opacity-60 mt-1",children:e.notification_type.replace("_"," ").toUpperCase()})]}),(0,Su.jsxs)("div",{className:"text-right text-sm opacity-70",children:[(0,Su.jsx)("div",{children:new Date(e.timestamp).toLocaleString()}),e.user_id===t.id&&!e.is_read&&(0,Su.jsx)("div",{className:"text-xs text-red-500 mt-1",children:"NEW"})]})]})},e.id)))})]})]}),(0,Su.jsx)(Gv,{user:k,isOpen:O,onClose:()=>I(!1)}),(0,Su.jsx)(Xv,{isOpen:U,onClose:()=>F(!1),currentUser:t,onUpdateUser:e=>{se(e),ue()}})]})}const Kv=()=>(0,Su.jsx)(Bv,{children:(0,Su.jsx)(Yv,{})});a.createRoot(document.getElementById("root")).render((0,Su.jsx)(r.StrictMode,{children:(0,Su.jsx)(Kv,{})}))})();
//# sourceMappingURL=main.f0032a4d.js.map